\chapter{Summary of \texttt{R} Codes Used}
\section*{Code for Time Series}

\begin{center}
\small
\captionof{listing}{\label{list:listingsummary} Summary of \texttt{R} codes used.}
\begin{Schunk}
\begin{Sinput}
rain=scan("baguiorainfall.dat")
rain
raintimeseries=ts(rain, frequency=12, start=c(2001,1))
raintimeseries
plot.ts(raintimeseries)
rainforecasts<- HoltWinters(raintimeseries)
rainforecasts
rainforecasts$SSE
plot(rainforecasts)
library(forecast)
rainforecasts2=forecast.HoltWinters(rainforecasts,h=12)
rainforecasts2
plot.forecast(rainforecasts2)
acf(rainforecasts2$residuals, lag.max=20)
Box.test(rainforecasts2$residuals, lag=20, type="Ljung-Box")
plot.ts(rainforecasts2$residuals)
plotForecastErrors=function(forecasterrors)
{
# make a red histogram of the forecast errors:
mybinsize=IQR(forecasterrors)/4
mymin=min(forecasterrors)*3
mymax=max(forecasterrors)*3
mybins=seq(mymin, mymax, mybinsize)
hist(forecasterrors, col="red", freq=FALSE, breaks=mybins)
# freq=FALSE ensures the area under the histogram = 1
mysd=sd(forecasterrors)
# generate normally distributed data with mean 0 and standard deviation mysd
mynorm=rnorm(10000, mean=0, sd=mysd)
myhist=hist(mynorm, plot=FALSE, breaks=mybins)
# plot the normal curve as a blue line on top of the histogram of forecast errors:
points(myhist$mids, myhist$density, type="l", col="blue", lwd=2)
}
plotForecastErrors(rainforecasts2$residuals)\end{Sinput}
\end{Schunk}
\end{center}

\chapter{Full output for the decomposed Bagiuo rainfall time deries data}

\begin{center}
\captionof{listing}{\label{fig:Components2} The seasonal, trend, and random components.}
\begin{Schunk}
\begin{Sinput}
baguiorainseriescomponents <- decompose(baguiorainseries)
baguiorainseriescomponents
\end{Sinput}
\begin{Soutput}
$x
          Jan      Feb      Mar      Apr      May      Jun      Jul
2001   14.600   39.500  289.800   76.000  291.000  451.400 1642.000
2002    5.000    2.000    0.600   71.200  264.400  411.000 1883.400
2003    9.800   25.400    4.800   46.800  662.700  792.400  721.300
2004   17.000  128.600   79.870   37.800  428.600 1306.500  445.400
2005    0.200    0.000   54.600   32.000  291.000  425.700  292.400
2006  160.600    8.800   38.400   29.600  327.509  188.200 1769.800
2007    0.000    0.600   31.800   25.400  308.600  358.400  219.000
2008   24.000   97.000   78.700  149.800  839.800  302.000  681.200
2009    8.000   64.500   82.900  407.300  298.500  810.000  758.400
2010   10.037    5.499   15.300  148.600  248.600  254.000  543.700
2011   94.000   13.800   88.900   11.900  462.500  529.100  435.900
          Aug      Sep      Oct      Nov      Dec
2001  274.000  842.200   97.000   61.600   23.200
2002  525.600  301.500  224.800   67.300   10.000
2003 1089.400  303.200  179.700   60.400    4.400
2004 1432.900  225.600   42.400  114.500  154.900
2005  690.200  694.600  256.600   55.200   68.000
2006  735.800  207.600  316.000   72.400   43.200
2007 1201.600  408.400  410.300  444.800   21.600
2008  999.500  761.000  178.100   82.600    0.000
2009 1087.700  516.900 1981.800   22.200    0.000
2010  536.600  296.800  920.100  226.400   47.400
2011 1096.300  819.200  332.400   81.600   67.400

$seasonal
         Jan     Feb     Mar     Apr     May     Jun     Jul     Aug
2001 -296.55 -293.19 -283.56 -235.99   80.13  204.37  561.21  522.65
2002 -296.55 -293.19 -283.56 -235.99   80.13  204.37  561.21  522.65
2003 -296.55 -293.19 -283.56 -235.99   80.13  204.37  561.21  522.65
2004 -296.55 -293.19 -283.56 -235.99   80.13  204.37  561.21  522.65
2005 -296.55 -293.19 -283.56 -235.99   80.13  204.37  561.21  522.65
2006 -296.55 -293.19 -283.56 -235.99   80.13  204.37  561.21  522.65
2007 -296.55 -293.19 -283.56 -235.99   80.13  204.37  561.21  522.65
2008 -296.55 -293.19 -283.56 -235.99   80.13  204.37  561.21  522.65
2009 -296.55 -293.19 -283.56 -235.99   80.13  204.37  561.21  522.65
2010 -296.55 -293.19 -283.56 -235.99   80.13  204.37  561.21  522.65
2011 -296.55 -293.19 -283.56 -235.99   80.13  204.37  561.21  522.65
         Sep     Oct     Nov     Dec
2001  122.05  128.05 -212.33 -296.84
2002  122.05  128.05 -212.33 -296.84
2003  122.05  128.05 -212.33 -296.84
2004  122.05  128.05 -212.33 -296.84
2005  122.05  128.05 -212.33 -296.84
2006  122.05  128.05 -212.33 -296.84
2007  122.05  128.05 -212.33 -296.84
2008  122.05  128.05 -212.33 -296.84
2009  122.05  128.05 -212.33 -296.84
2010  122.05  128.05 -212.33 -296.84
2011  122.05  128.05 -212.33 -296.84

$trend
       Jan   Feb   Mar   Apr   May   Jun   Jul   Aug   Sep   Oct   Nov
2001    NA    NA    NA    NA    NA    NA 341.5 339.5 325.9 313.6 312.3
2002 317.9 338.4 326.4 309.2 314.8 314.4 314.1 315.3 316.4 315.6 331.2
2003 331.1 306.2 329.8 327.9 325.8 325.3 325.3 329.9 337.4 340.1 330.0
2004 351.6 354.4 365.5 356.5 353.0 361.6 367.1 361.1 354.7 353.4 347.4
2005 261.9 224.6 213.2 241.6 248.1 242.0 245.1 252.1 251.8 251.0 252.4
2006 295.7 359.2 340.8 323.0 326.2 325.9 318.1 311.1 310.5 310.0 309.1
2007 257.8 212.6 240.4 252.7 272.2 286.8 286.9 291.9 297.9 305.0 332.3
2008 369.0 379.8 386.1 391.1 366.4 350.4 348.8 346.8 345.6 356.5 344.7
2009 367.7 374.6 368.1 433.1 505.7 503.2 503.3 500.9 495.6 482.0 469.2
2010 411.8 379.9 347.8 294.4 258.6 269.1 274.6 278.4 281.8 279.2 282.4
2011 309.8 328.6 373.7 371.0 340.4 335.2    NA    NA    NA    NA    NA
       Dec
2001 309.5
2002 363.7
2003 341.6
2004 305.0
2005 244.1
2006 315.4
2007 352.1
2008 343.3
2009 443.9
2010 302.8
2011    NA

$random
          Jan      Feb      Mar      Apr      May      Jun      Jul
2001       NA       NA       NA       NA       NA       NA  739.334
2002  -16.360  -43.257  -42.248   -2.012 -130.491 -107.820 1008.092
2003  -24.773   12.401  -41.398  -45.158  256.792  262.771 -165.233
2004  -38.020   67.408   -2.038  -82.722   -4.572  740.561 -482.947
2005   34.856   68.622  124.989   26.355  -37.216  -20.666 -513.866
2006  161.414  -57.200  -18.845  -57.396  -78.796 -342.030  890.458
2007   38.698   81.151   74.939    8.675  -43.687 -132.745 -629.083
2008  -48.460   10.347  -23.861   -5.345  393.305 -252.745 -228.816
2009  -63.135  -16.882   -1.623  210.225 -287.329  102.446 -306.076
2010 -105.222  -81.207  -48.910   90.231  -90.157 -219.482 -292.093
2011   80.773  -21.612   -1.236 -123.083   41.921  -10.520       NA
          Aug      Sep      Oct      Nov      Dec
2001 -588.150  394.268 -344.686  -38.390   10.510
2002 -312.329 -136.973 -218.836  -51.528  -56.807
2003  236.821 -156.201 -288.458  -57.242  -40.400
2004  549.165 -251.118 -439.028  -20.565  146.777
2005  -84.563  320.752 -122.478   15.089  120.772
2006  -97.955 -224.932 -122.087  -24.336   24.668
2007  387.054  -11.511  -22.753  324.818  -33.657
2008  130.058  293.343 -306.465  -49.753  -46.457
2009   64.151 -100.768 1371.724 -234.631 -147.076
2010 -264.483 -107.090  512.835  156.306   41.439
2011       NA       NA       NA       NA       NA

$figure
 [1] -296.55 -293.19 -283.56 -235.99   80.13  204.37  561.21  522.65
 [9]  122.05  128.05 -212.33 -296.84

$type
[1] "additive"

attr(,"class")
[1] "decomposed.ts"
\end{Soutput}
\end{Schunk}
\end{center}


\begin{center}
\begin{Schunk}
\begin{Sinput}
baguiorainseriesforecasts$fitted
\end{Sinput}
\begin{Soutput}
            xhat   level
Feb 2001   14.60   14.60
Mar 2001   27.22   27.22
Apr 2001  160.31  160.31
May 2001  117.58  117.58
Jun 2001  205.48  205.48
Jul 2001  330.13  330.13
Aug 2001  995.07  995.07
Sep 2001  629.58  629.58
Oct 2001  737.35  737.35
Nov 2001  412.78  412.78
Dec 2001  234.78  234.78
Jan 2002  127.54  127.54
Feb 2002   65.43   65.43
Mar 2002   33.28   33.28
Apr 2002   16.72   16.72
May 2002   44.33   44.33
Jun 2002  155.88  155.88
Jul 2002  285.19  285.19
Aug 2002 1095.26 1095.26
Sep 2002  806.52  806.52
Oct 2002  550.55  550.55
Nov 2002  385.44  385.44
Dec 2002  224.19  224.19
Jan 2003  115.62  115.62
Feb 2003   61.99   61.99
Mar 2003   43.44   43.44
Apr 2003   23.86   23.86
May 2003   35.49   35.49
Jun 2003  353.40  353.40
Jul 2003  575.91  575.91
Aug 2003  649.60  649.60
Sep 2003  872.52  872.52
Oct 2003  583.95  583.95
Nov 2003  379.05  379.05
Dec 2003  217.54  217.54
Jan 2004  109.51  109.51
Feb 2004   62.62   62.62
Mar 2004   96.06   96.06
Apr 2004   87.86   87.86
May 2004   62.48   62.48
Jun 2004  248.05  248.05
Jul 2004  784.54  784.54
Aug 2004  612.64  612.64
Sep 2004 1028.40 1028.40
Oct 2004  621.49  621.49
Nov 2004  327.97  327.97
Dec 2004  219.77  219.77
Jan 2005  186.89  186.89
Feb 2005   92.26   92.26
Mar 2005   45.50   45.50
Apr 2005   50.11   50.11
May 2005   40.93   40.93
Jun 2005  167.68  167.68
Jul 2005  298.46  298.46
Aug 2005  295.39  295.39
Sep 2005  495.50  495.50
Oct 2005  596.42  596.42
Nov 2005  424.18  424.18
Dec 2005  237.16  237.16
Jan 2006  151.42  151.42
Feb 2006  156.07  156.07
Mar 2006   81.43   81.43
Apr 2006   59.62   59.62
May 2006   44.40   44.40
Jun 2006  187.90  187.90
Jul 2006  188.05  188.05
Aug 2006  989.78  989.78
Sep 2006  861.05  861.05
Oct 2006  529.84  529.84
Nov 2006  421.45  421.45
Dec 2006  244.53  244.53
Jan 2007  142.48  142.48
Feb 2007   70.26   70.26
Mar 2007   34.95   34.95
Apr 2007   33.36   33.36
May 2007   29.32   29.32
Jun 2007  170.88  170.88
Jul 2007  265.93  265.93
Aug 2007  242.14  242.14
Sep 2007  728.45  728.45
Oct 2007  566.23  566.23
Nov 2007  487.20  487.20
Dec 2007  465.71  465.71
Jan 2008  240.61  240.61
Feb 2008  130.82  130.82
Mar 2008  113.68  113.68
Apr 2008   95.95   95.95
May 2008  123.24  123.24
Jun 2008  486.44  486.44
Jul 2008  392.95  392.95
Aug 2008  539.05  539.05
Sep 2008  772.44  772.44
Oct 2008  766.64  766.64
Nov 2008  468.33  468.33
Dec 2008  272.82  272.82
Jan 2009  134.54  134.54
Feb 2009   70.40   70.40
Mar 2009   67.41   67.41
Apr 2009   75.26   75.26
May 2009  243.56  243.56
Jun 2009  271.41  271.41
Jul 2009  544.40  544.40
Aug 2009  652.87  652.87
Sep 2009  873.27  873.27
Oct 2009  692.64  692.64
Nov 2009 1346.07 1346.07
Dec 2009  675.05  675.05
Jan 2010  332.89  332.89
Feb 2010  169.25  169.25
Mar 2010   86.25   86.25
Apr 2010   50.29   50.29
May 2010  100.12  100.12
Jun 2010  175.38  175.38
Jul 2010  215.23  215.23
Aug 2010  381.72  381.72
Sep 2010  460.22  460.22
Oct 2010  377.39  377.39
Nov 2010  652.47  652.47
Dec 2010  436.51  436.51
Jan 2011  239.29  239.29
Feb 2011  165.65  165.65
Mar 2011   88.68   88.68
Apr 2011   88.79   88.79
May 2011   49.82   49.82
Jun 2011  258.99  258.99
Jul 2011  395.90  395.90
Aug 2011  416.17  416.17
Sep 2011  760.90  760.90
Oct 2011  790.45  790.45
Nov 2011  558.28  558.28
Dec 2011  316.67  316.67
\end{Soutput}
\end{Schunk}

\captionof{figure}{\label{fig:fitted2} The full forecast for the period January 2000 to December 2011 using Holt Winters.}
\end{center}
